<!DOCTYPE html>
<html>
<head>
    <title>View Assets</title>
</head>
<body>
    <h1>All IT Assets</h1>

    <div>
        <label for="statusFilter">Filter by Status:</label>
        <select id="statusFilter">
            <option value="All">All</option>
            <option value="Active">Active</option>
            <option value="Retired">Retired</option>
            <option value="Missing">Missing</option>
        </select>
        &nbsp; <!-- Add some spacing -->
        <a href="/export_csv?status={{ current_status }}" role="button">Export to CSV</a>
    </div>
    <br>

    <table border="1">
        <thead>
            <tr>
                <th>Asset Name</th>
                <th>Type</th>
                <th>Assigned To</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for asset in assets %}
            <tr>
                <td>{{ asset[1] }}</td>
                <td>{{ asset[2] }}</td>
                <td>{{ asset[3] }}</td>
                <td>{{ asset[4] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        const statusFilter = document.getElementById('statusFilter');
        // Get the current status passed from Flask (already defaults to 'Active' server-side if needed)
        const currentStatus = '{{ current_status }}';

        // Set the initial value of the dropdown
        statusFilter.value = currentStatus;

        statusFilter.addEventListener('change', function() {
            const selectedStatus = this.value;
            if (selectedStatus.toLowerCase() === 'all') {
                window.location.href = '/view'; // Redirect to /view without status query param for "All"
            } else {
                window.location.href = `/view?status=${selectedStatus}`;
            }
        });
    </script>
</body>
</html>
